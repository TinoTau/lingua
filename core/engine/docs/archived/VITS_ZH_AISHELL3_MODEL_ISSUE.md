# VITS 中文 AISHELL3 模型问题分析

**日期**: 2024-12-19  
**问题**: 所有 tokenizer 格式都无法生成可识别的音频

---

## 问题确认

### 测试结果
- ✅ Tokenizer 编码正确（所有格式都测试过）
- ✅ 模型可以正常加载和推理
- ✅ 生成的音频文件存在且长度合理
- ❌ **所有格式的音频都无法识别任何一个字**

### 可能的原因

1. **模型本身的问题**
   - 模型可能不适合直接使用
   - 模型可能需要特定的预处理或后处理
   - 模型训练质量可能有问题

2. **模型输入格式问题**
   - 虽然 tokenizer 编码看起来正确，但模型可能期望不同的格式
   - 可能需要检查原始实现的示例代码

3. **模型文件问题**
   - ONNX 模型可能导出有问题
   - 可能需要使用原始 PyTorch 模型进行对比

4. **模型不适用**
   - 这个模型可能不适合我们的使用场景
   - 可能需要使用其他中文 TTS 模型

---

## 建议的解决方案

### 方案 1: 检查原始实现
查看 `csukuangfj/vits_chinese` 的 GitHub 仓库：
- https://github.com/csukuangfj/vits_chinese
- 查看 `export_onnx_aishell3.py` 的代码
- 查看是否有示例代码或文档
- 确认正确的使用方式

### 方案 2: 使用其他中文 TTS 模型
如果原始实现无法找到或问题无法解决，考虑：
- **MMS TTS 中文模型**（如果可用）
- **其他 VITS 中文模型**
- **其他 TTS 方案**（如 FastSpeech2 + HiFiGAN，但之前也有问题）

### 方案 3: 检查模型文件
- 确认模型文件是否正确下载
- 检查模型文件是否完整
- 尝试使用原始 PyTorch 模型进行对比

---

## 当前状态

- ✅ Tokenizer 实现完成
- ✅ 模型加载完成
- ✅ 推理逻辑实现完成
- ✅ 参数调优完成
- ✅ 多种格式测试完成
- ❌ **音频质量不理想（无法识别任何一个字）**

---

## 下一步

1. **检查原始实现的 GitHub 仓库**，确认正确的使用方式
2. **运行模型检查脚本** (`scripts/check_model_io_detailed.py`)，查看模型输入输出
3. **考虑使用其他中文 TTS 模型**，如果问题无法解决

---

## 参考信息

- 原始仓库: https://github.com/csukuangfj/vits_chinese
- 模型来源: https://huggingface.co/jackyqs/vits-aishell3-175-chinese
- ONNX 导出脚本: `export_onnx_aishell3.py`

