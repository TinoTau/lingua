# VITS 中文 AISHELL3 问题分析

**日期**: 2024-12-19  
**问题**: 生成的音频语速过快，听不清每一个字，一个字都不对

---

## 问题确认

### Python 测试结果
- ✅ Tokenizer 编码正确（与 Rust 输出一致）
- ❌ Python 生成的音频也不正确（语速过快，听不清）
- **结论**: 问题不在 Rust 实现，而在模型使用方式或参数设置

---

## 可能的原因

### 1. 模型质量问题
- vits-zh-aishell3 模型本身可能存在问题
- 模型可能不适合直接使用，需要额外的预处理或后处理

### 2. 参数设置问题
- 默认参数可能不适合该模型
- 需要找到正确的参数组合

### 3. Tokenizer 编码问题
- 虽然 token IDs 看起来正确，但可能编码格式不对
- 可能需要参考原始实现的编码方式

### 4. 模型输入格式问题
- 可能需要额外的预处理步骤
- 输入格式可能与预期不符

---

## 建议的解决方案

### 方案 1: 参数调优
运行参数调优脚本，测试不同的参数组合：

```powershell
python scripts/test_vits_zh_aishell3_parameter_tuning.py
```

这会生成多个音频文件，每个使用不同的参数组合，请选择最佳的一个。

### 方案 2: 检查原始实现
查看原始模型的 GitHub 仓库，了解正确的使用方法：
- https://github.com/csukuangfj/vits_chinese
- 查看 `export_onnx_aishell3.py` 和示例代码

### 方案 3: 尝试其他中文 TTS 模型
如果 vits-zh-aishell3 模型确实有问题，可以考虑：
- 使用其他中文 VITS 模型
- 使用 MMS TTS 中文模型（如果存在）
- 使用其他 TTS 方案

---

## 当前状态

- ✅ Tokenizer 实现完成
- ✅ 模型加载完成
- ✅ 推理逻辑实现完成
- ❌ 音频质量不理想（语速过快，听不清）

---

## 下一步

1. **运行参数调优脚本**，测试不同参数组合
2. **检查原始实现**，确认正确的使用方式
3. **考虑替代方案**，如果模型确实有问题

